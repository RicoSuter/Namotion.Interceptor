// <auto-generated>
//     This code was generated by Namotion.Interceptor.Generator
// </auto-generated>

using Namotion.Interceptor;
using Namotion.Interceptor.Interceptors;

using System;
using System.Collections.Concurrent;
using System.Collections.Generic;
using System.Collections.Frozen;
using System.ComponentModel;
using System.Linq;
using System.Reflection;
using System.Runtime.CompilerServices;
using System.Text.Json.Serialization;

#pragma warning disable CS8669
#pragma warning disable CS0649
#pragma warning disable CS0067

namespace YourDefaultNamespace
{
    public partial class WeatherStation : IInterceptorSubject, INotifyPropertyChanged, IRaisePropertyChanged
    {
        public event PropertyChangedEventHandler? PropertyChanged;

        [MethodImpl(MethodImplOptions.AggressiveInlining)]
        protected void RaisePropertyChanged(string propertyName) => PropertyChanged?.Invoke(this, PropertyChangedEventArgsCache.Get(propertyName));

        void IRaisePropertyChanged.RaisePropertyChanged(string propertyName) => RaisePropertyChanged(propertyName);

        private IInterceptorExecutor? _context;
        private IReadOnlyDictionary<string, SubjectPropertyMetadata>? _properties;

        [JsonIgnore]
        IInterceptorSubjectContext IInterceptorSubject.Context => _context ??= new InterceptorExecutor(this);

        [JsonIgnore]
        ConcurrentDictionary<(string? property, string key), object?> IInterceptorSubject.Data { get; } = new();

        [JsonIgnore]
        IReadOnlyDictionary<string, SubjectPropertyMetadata> IInterceptorSubject.Properties => _properties ?? DefaultProperties;

        [JsonIgnore]
        object IInterceptorSubject.SyncRoot { get; } = new object();

        void IInterceptorSubject.AddProperties(params IEnumerable<SubjectPropertyMetadata> properties)
        {
            _properties = (_properties ?? DefaultProperties)
                .Concat(properties.Select(p => new KeyValuePair<string, SubjectPropertyMetadata>(p.Name, p)))
                .ToFrozenDictionary();
        }

        public static IReadOnlyDictionary<string, SubjectPropertyMetadata> DefaultProperties { get; } =
            new Dictionary<string, SubjectPropertyMetadata>
            {
                {
                    "Temperature",
                    new SubjectPropertyMetadata(
                        typeof(WeatherStation).GetProperty(nameof(Temperature), BindingFlags.Public | BindingFlags.NonPublic | BindingFlags.Instance)!,
                        (o) => ((WeatherStation)o).Temperature,
                        (o, v) => ((WeatherStation)o).Temperature = (double)v,
                        isIntercepted: true,
                        isDynamic: false)
                },
                {
                    "Humidity",
                    new SubjectPropertyMetadata(
                        typeof(WeatherStation).GetProperty(nameof(Humidity), BindingFlags.Public | BindingFlags.NonPublic | BindingFlags.Instance)!,
                        (o) => ((WeatherStation)o).Humidity,
                        (o, v) => ((WeatherStation)o).Humidity = (double)v,
                        isIntercepted: true,
                        isDynamic: false)
                },
                {
                    "IsHot",
                    new SubjectPropertyMetadata(
                        typeof(global::IHasTemperature).GetProperty(nameof(global::IHasTemperature.IsHot), BindingFlags.Public | BindingFlags.NonPublic | BindingFlags.Instance)!,
                        (o) => ((global::IHasTemperature)o).IsHot,
                        null,
                        isIntercepted: false,
                        isDynamic: false)
                },
                {
                    "IsHumid",
                    new SubjectPropertyMetadata(
                        typeof(global::IHasHumidity).GetProperty(nameof(global::IHasHumidity.IsHumid), BindingFlags.Public | BindingFlags.NonPublic | BindingFlags.Instance)!,
                        (o) => ((global::IHasHumidity)o).IsHumid,
                        null,
                        isIntercepted: false,
                        isDynamic: false)
                },
            }
            .ToFrozenDictionary();

        public WeatherStation()
        {
        }

        public WeatherStation(IInterceptorSubjectContext context) : this()
        {
            ((IInterceptorSubject)this).Context.AddFallbackContext(context);
        }

        private double _Temperature;

        public partial double Temperature
        {
            get
            {
                return GetPropertyValue<double>(nameof(Temperature), static (o) => ((WeatherStation)o)._Temperature);
            }
            set
            {
                var newValue = value;
                var cancel = false;
                OnTemperatureChanging(ref newValue, ref cancel);
                if (!cancel && SetPropertyValue(nameof(Temperature), newValue, static (o) => ((WeatherStation)o)._Temperature, static (o, v) => ((WeatherStation)o)._Temperature = v))
                {
                    OnTemperatureChanged(_Temperature);
                    RaisePropertyChanged(nameof(Temperature));
                }
            }
        }

        partial void OnTemperatureChanging(ref double newValue, ref bool cancel);

        partial void OnTemperatureChanged(double newValue);

        private double _Humidity;

        public partial double Humidity
        {
            get
            {
                return GetPropertyValue<double>(nameof(Humidity), static (o) => ((WeatherStation)o)._Humidity);
            }
            set
            {
                var newValue = value;
                var cancel = false;
                OnHumidityChanging(ref newValue, ref cancel);
                if (!cancel && SetPropertyValue(nameof(Humidity), newValue, static (o) => ((WeatherStation)o)._Humidity, static (o, v) => ((WeatherStation)o)._Humidity = v))
                {
                    OnHumidityChanged(_Humidity);
                    RaisePropertyChanged(nameof(Humidity));
                }
            }
        }

        partial void OnHumidityChanging(ref double newValue, ref bool cancel);

        partial void OnHumidityChanged(double newValue);

        [MethodImpl(MethodImplOptions.AggressiveInlining)]
        private TProperty GetPropertyValue<TProperty>(string propertyName, Func<IInterceptorSubject, TProperty> readValue)
        {
            return _context is not null ? _context.GetPropertyValue(propertyName, readValue)! : readValue(this)!;
        }

        [MethodImpl(MethodImplOptions.AggressiveInlining)]
        private bool SetPropertyValue<TProperty>(string propertyName, TProperty newValue, Func<IInterceptorSubject, TProperty> readValue, Action<IInterceptorSubject, TProperty> setValue)
        {
            if (_context is null)
            {
                setValue(this, newValue);
                return true;
            }
            else
            {
                return _context.SetPropertyValue(propertyName, newValue, readValue, setValue);
            }
        }

        [MethodImpl(MethodImplOptions.AggressiveInlining)]
        private object? InvokeMethod(string methodName, Func<IInterceptorSubject, object?[], object?> invokeMethod, params object?[] parameters)
        {
            return _context is not null ? _context.InvokeMethod(methodName, parameters, invokeMethod) : invokeMethod(this, parameters);
        }
    }
}
